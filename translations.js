// Egyptian Arabic Translations
const translations = {
    en: {
        // Hero Section
        heroTitle: 'The Last Five Coptic Orthodox Popes',
        heroSubtitle: 'A Legacy of Faith, Leadership & Cultural Impact',
        heroYears: '114th - 118th Successors of St. Mark (1942 - Present)',

        // Navigation
        navBrand: 'Coptic Heritage',
        navOverview: 'Overview',
        navTimeline: 'Timeline',
        navPopes: 'Popes',
        navImpact: 'Impact Analysis',
        navEvents: 'Historical Events',
        navComparison: 'Quick View',

        // Overview Section
        overviewTitle: 'Overview of the Papacy',
        overviewDescription: 'The Coptic Orthodox Church traces its apostolic succession through St. Mark the Evangelist. The last five popes have led the church through extraordinary times, from World War II through the digital age, facing challenges and achieving remarkable growth.',
        statYearsCovered: 'Years Covered',
        statYearsRange: '(1942-2025)',
        statPopes: 'Popes',
        statPopesRange: '(114th-118th)',
        statLongestPapacy: 'Longest Papacy',
        statLongestName: 'Pope Shenouda III',
        statShortestPapacy: 'Shortest Papacy',
        statShortestName: 'Pope Macarius III',

        // Timeline Section
        timelineTitle: 'Interactive Timeline',
        timelineDescription: 'Journey through 82+ years of Coptic Orthodox history, from 1942 to the present day',

        // Popes Section
        popesTitle: 'The Five Popes',
        popesDescription: 'Explore the lives, achievements, and lasting legacies of each patriarch',
        popeOfAlexandria: 'Pope of Alexandria',
        birthName: 'Birth Name',
        learnMore: 'Learn More',
        yearServed: 'year',
        yearsServed: 'years',
        served: 'served',

        // Tabs
        tabBiography: 'Biography',
        tabAchievements: 'Achievements',
        tabChallenges: 'Challenges',
        tabCulturalImpact: 'Cultural Impact',
        tabHistoricalContext: 'Historical Context',

        // Tab Content Headers
        biographyHeader: 'Biography',
        achievementsHeader: 'Major Achievements',
        challengesHeader: 'Challenges & Trials',
        culturalImpactHeader: 'Cultural Impact',
        legacyHeader: 'Legacy',
        historicalContextHeader: 'Historical Context',
        yearsLabel: 'Years:',
        birthPlaceLabel: 'Birth Place:',
        present: 'Present',

        // Impact Analysis Section
        impactTitle: 'Impact Analysis',
        impactDescription: 'Comparative assessment across key dimensions of papal leadership',
        impactInstitutional: 'Institutional Development',
        impactSpiritual: 'Spiritual Revival',
        impactGlobal: 'Global Expansion',
        impactChurchState: 'Church-State Relations',
        impactInfrastructure: 'Infrastructure Building',
        average: 'Average',

        // Historical Events Section
        eventsTitle: 'Key Historical Events',
        eventsDescription: 'Major milestones that shaped the modern Coptic Orthodox Church',

        // Comparison Table Section
        comparisonTitle: 'Quick Comparison View',
        comparisonDescription: 'Side-by-side analysis of all five popes',
        thPope: 'Pope',
        thYearsServed: 'Years Served',
        thKeyAchievement: 'Key Achievement',
        thMajorChallenge: 'Major Challenge',
        thCulturalLegacy: 'Cultural Legacy',

        // Footer
        footerEducational: 'Educational Resource:',
        footerDescription: 'This educational resource celebrates the spiritual leadership and cultural impact of the Coptic Orthodox Church.',
        footerVisit: 'For more information, visit the',
        footerLink: 'Official Coptic Orthodox Church Website',
        footerCopyright: 'Â© 2025 Coptic Heritage Dashboard. All rights reserved.'
    },
    ar: {
        // Hero Section
        heroTitle: 'Ø¢Ø®Ø± Ø®Ù…Ø³Ø© Ø¨Ø§Ø¨Ø§ÙˆØ§Øª Ù„Ù„ÙƒÙ†ÙŠØ³Ø© Ø§Ù„Ù‚Ø¨Ø·ÙŠØ© Ø§Ù„Ø£Ø±Ø«ÙˆØ°ÙƒØ³ÙŠØ©',
        heroSubtitle: 'Ø¥Ø±Ø« Ù…Ù† Ø§Ù„Ø¥ÙŠÙ…Ø§Ù† ÙˆØ§Ù„Ù‚ÙŠØ§Ø¯Ø© ÙˆØ§Ù„ØªØ£Ø«ÙŠØ± Ø§Ù„Ø«Ù‚Ø§ÙÙŠ',
        heroYears: 'Ø§Ù„Ø®Ù„ÙØ§Ø¡ Ù¡Ù¡Ù¤ - Ù¡Ù¡Ù¨ Ù„Ù„Ù‚Ø¯ÙŠØ³ Ù…Ø±Ù‚Ø³ (Ù¡Ù©Ù¤Ù¢ - Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†)',

        // Navigation
        navBrand: 'Ø§Ù„ØªØ±Ø§Ø« Ø§Ù„Ù‚Ø¨Ø·ÙŠ',
        navOverview: 'Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©',
        navTimeline: 'Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ',
        navPopes: 'Ø§Ù„Ø¨Ø§Ø¨Ø§ÙˆØ§Øª',
        navImpact: 'ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªØ£Ø«ÙŠØ±',
        navEvents: 'Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠØ©',
        navComparison: 'Ø¹Ø±Ø¶ Ø³Ø±ÙŠØ¹',

        // Overview Section
        overviewTitle: 'Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø§Ø¨ÙˆÙŠØ©',
        overviewDescription: 'ØªØªØªØ¨Ø¹ Ø§Ù„ÙƒÙ†ÙŠØ³Ø© Ø§Ù„Ù‚Ø¨Ø·ÙŠØ© Ø§Ù„Ø£Ø±Ø«ÙˆØ°ÙƒØ³ÙŠØ© Ø®Ù„Ø§ÙØªÙ‡Ø§ Ø§Ù„Ø±Ø³ÙˆÙ„ÙŠØ© Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„Ù‚Ø¯ÙŠØ³ Ù…Ø±Ù‚Ø³ Ø§Ù„Ø¥Ù†Ø¬ÙŠÙ„ÙŠ. Ù‚Ø§Ø¯ Ø§Ù„Ø¨Ø§Ø¨Ø§ÙˆØ§Øª Ø§Ù„Ø®Ù…Ø³Ø© Ø§Ù„Ø£Ø®ÙŠØ±ÙˆÙ† Ø§Ù„ÙƒÙ†ÙŠØ³Ø© Ø®Ù„Ø§Ù„ Ø£ÙˆÙ‚Ø§Øª Ø§Ø³ØªØ«Ù†Ø§Ø¦ÙŠØ©ØŒ Ù…Ù† Ø§Ù„Ø­Ø±Ø¨ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ© Ø§Ù„Ø«Ø§Ù†ÙŠØ© Ø­ØªÙ‰ Ø§Ù„Ø¹ØµØ± Ø§Ù„Ø±Ù‚Ù…ÙŠØŒ Ù…ÙˆØ§Ø¬Ù‡ÙŠÙ† Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª ÙˆÙ…Ø­Ù‚Ù‚ÙŠÙ† Ù†Ù…ÙˆÙ‹Ø§ Ù…Ù„Ø­ÙˆØ¸Ù‹Ø§.',
        statYearsCovered: 'Ø§Ù„Ø³Ù†ÙˆØ§Øª Ø§Ù„Ù…ØºØ·Ø§Ø©',
        statYearsRange: '(Ù¡Ù©Ù¤Ù¢-Ù¢Ù Ù¢Ù¥)',
        statPopes: 'Ø§Ù„Ø¨Ø§Ø¨Ø§ÙˆØ§Øª',
        statPopesRange: '(Ù¡Ù¡Ù¤-Ù¡Ù¡Ù¨)',
        statLongestPapacy: 'Ø£Ø·ÙˆÙ„ Ø¨Ø§Ø¨ÙˆÙŠØ©',
        statLongestName: 'Ø§Ù„Ø¨Ø§Ø¨Ø§ Ø´Ù†ÙˆØ¯Ø© Ø§Ù„Ø«Ø§Ù„Ø«',
        statShortestPapacy: 'Ø£Ù‚ØµØ± Ø¨Ø§Ø¨ÙˆÙŠØ©',
        statShortestName: 'Ø§Ù„Ø¨Ø§Ø¨Ø§ Ù…ÙƒØ§Ø±ÙŠÙˆØ³ Ø§Ù„Ø«Ø§Ù„Ø«',

        // Timeline Section
        timelineTitle: 'Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ',
        timelineDescription: 'Ø±Ø­Ù„Ø© Ø¹Ø¨Ø± Ø£ÙƒØ«Ø± Ù…Ù† Ù¨Ù¢ Ø¹Ø§Ù…Ù‹Ø§ Ù…Ù† ØªØ§Ø±ÙŠØ® Ø§Ù„ÙƒÙ†ÙŠØ³Ø© Ø§Ù„Ù‚Ø¨Ø·ÙŠØ© Ø§Ù„Ø£Ø±Ø«ÙˆØ°ÙƒØ³ÙŠØ©ØŒ Ù…Ù† Ù¡Ù©Ù¤Ù¢ Ø­ØªÙ‰ ÙŠÙˆÙ…Ù†Ø§ Ù‡Ø°Ø§',

        // Popes Section
        popesTitle: 'Ø§Ù„Ø¨Ø§Ø¨Ø§ÙˆØ§Øª Ø§Ù„Ø®Ù…Ø³Ø©',
        popesDescription: 'Ø§Ø³ØªÙƒØ´Ù Ø­ÙŠØ§Ø© ÙˆØ¥Ù†Ø¬Ø§Ø²Ø§Øª ÙˆØ¥Ø±Ø« ÙƒÙ„ Ø¨Ø·Ø±ÙŠØ±Ùƒ',
        popeOfAlexandria: 'Ø¨Ø§Ø¨Ø§ Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©',
        birthName: 'Ø§Ø³Ù… Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯',
        learnMore: 'Ø§Ø¹Ø±Ù Ø§Ù„Ù…Ø²ÙŠØ¯',
        yearServed: 'Ø³Ù†Ø©',
        yearsServed: 'Ø³Ù†ÙˆØ§Øª',
        served: 'ÙÙŠ Ø§Ù„Ø®Ø¯Ù…Ø©',

        // Tabs
        tabBiography: 'Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©',
        tabAchievements: 'Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª',
        tabChallenges: 'Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª',
        tabCulturalImpact: 'Ø§Ù„ØªØ£Ø«ÙŠØ± Ø§Ù„Ø«Ù‚Ø§ÙÙŠ',
        tabHistoricalContext: 'Ø§Ù„Ø³ÙŠØ§Ù‚ Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠ',

        // Tab Content Headers
        biographyHeader: 'Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©',
        achievementsHeader: 'Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©',
        challengesHeader: 'Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª ÙˆØ§Ù„Ù…Ø­Ù†',
        culturalImpactHeader: 'Ø§Ù„ØªØ£Ø«ÙŠØ± Ø§Ù„Ø«Ù‚Ø§ÙÙŠ',
        legacyHeader: 'Ø§Ù„Ø¥Ø±Ø«',
        historicalContextHeader: 'Ø§Ù„Ø³ÙŠØ§Ù‚ Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠ',
        yearsLabel: 'Ø§Ù„Ø³Ù†ÙˆØ§Øª:',
        birthPlaceLabel: 'Ù…ÙƒØ§Ù† Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯:',
        present: 'Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†',

        // Impact Analysis Section
        impactTitle: 'ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªØ£Ø«ÙŠØ±',
        impactDescription: 'ØªÙ‚ÙŠÙŠÙ… Ù…Ù‚Ø§Ø±Ù† Ø¹Ø¨Ø± Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„Ù‚ÙŠØ§Ø¯Ø© Ø§Ù„Ø¨Ø§Ø¨ÙˆÙŠØ©',
        impactInstitutional: 'Ø§Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ø¤Ø³Ø³ÙŠ',
        impactSpiritual: 'Ø§Ù„Ù†Ù‡Ø¶Ø© Ø§Ù„Ø±ÙˆØ­ÙŠØ©',
        impactGlobal: 'Ø§Ù„ØªÙˆØ³Ø¹ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ',
        impactChurchState: 'Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø¨ÙŠÙ† Ø§Ù„ÙƒÙ†ÙŠØ³Ø© ÙˆØ§Ù„Ø¯ÙˆÙ„Ø©',
        impactInfrastructure: 'Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªØ­ØªÙŠØ©',
        average: 'Ø§Ù„Ù…ØªÙˆØ³Ø·',

        // Historical Events Section
        eventsTitle: 'Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©',
        eventsDescription: 'Ø§Ù„Ù…Ø¹Ø§Ù„Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø§Ù„ØªÙŠ Ø´ÙƒÙ„Øª Ø§Ù„ÙƒÙ†ÙŠØ³Ø© Ø§Ù„Ù‚Ø¨Ø·ÙŠØ© Ø§Ù„Ø£Ø±Ø«ÙˆØ°ÙƒØ³ÙŠØ© Ø§Ù„Ø­Ø¯ÙŠØ«Ø©',

        // Comparison Table Section
        comparisonTitle: 'Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø³Ø±ÙŠØ¹Ø©',
        comparisonDescription: 'ØªØ­Ù„ÙŠÙ„ Ø¬Ù†Ø¨Ù‹Ø§ Ø¥Ù„Ù‰ Ø¬Ù†Ø¨ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø§Ø¨Ø§ÙˆØ§Øª Ø§Ù„Ø®Ù…Ø³Ø©',
        thPope: 'Ø§Ù„Ø¨Ø§Ø¨Ø§',
        thYearsServed: 'Ø³Ù†ÙˆØ§Øª Ø§Ù„Ø®Ø¯Ù…Ø©',
        thKeyAchievement: 'Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ',
        thMajorChallenge: 'Ø§Ù„ØªØ­Ø¯ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ',
        thCulturalLegacy: 'Ø§Ù„Ø¥Ø±Ø« Ø§Ù„Ø«Ù‚Ø§ÙÙŠ',

        // Footer
        footerEducational: 'Ù…ÙˆØ±Ø¯ ØªØ¹Ù„ÙŠÙ…ÙŠ:',
        footerDescription: 'ÙŠØ­ØªÙÙ„ Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆØ±Ø¯ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ Ø¨Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© Ø§Ù„Ø±ÙˆØ­ÙŠØ© ÙˆØ§Ù„ØªØ£Ø«ÙŠØ± Ø§Ù„Ø«Ù‚Ø§ÙÙŠ Ù„Ù„ÙƒÙ†ÙŠØ³Ø© Ø§Ù„Ù‚Ø¨Ø·ÙŠØ© Ø§Ù„Ø£Ø±Ø«ÙˆØ°ÙƒØ³ÙŠØ©.',
        footerVisit: 'Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªØŒ Ù‚Ù… Ø¨Ø²ÙŠØ§Ø±Ø©',
        footerLink: 'Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø³Ù…ÙŠ Ù„Ù„ÙƒÙ†ÙŠØ³Ø© Ø§Ù„Ù‚Ø¨Ø·ÙŠØ© Ø§Ù„Ø£Ø±Ø«ÙˆØ°ÙƒØ³ÙŠØ©',
        footerCopyright: 'Â© Ù¢Ù Ù¢Ù¥ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ±Ø§Ø« Ø§Ù„Ù‚Ø¨Ø·ÙŠ. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.'
    }
};

// Current language state
let currentLanguage = 'en';

// Function to get translation
function t(key) {
    return translations[currentLanguage][key] || translations.en[key] || key;
}

// Function to toggle language
function toggleLanguage() {
    currentLanguage = currentLanguage === 'en' ? 'ar' : 'en';

    // Update HTML lang attribute
    document.documentElement.lang = currentLanguage;

    // Update text direction for Arabic
    document.documentElement.dir = currentLanguage === 'ar' ? 'rtl' : 'ltr';

    // Update toggle UI
    const track = document.getElementById('languageToggleTrack');
    const activeFlag = document.getElementById('activeFlag');

    if (currentLanguage === 'ar') {
        track.classList.add('ar');
        activeFlag.textContent = 'ðŸ‡ªðŸ‡¬';
    } else {
        track.classList.remove('ar');
        activeFlag.textContent = 'ðŸ‡ºðŸ‡¸';
    }

    // Update all translatable content
    updateTranslations();

    // Save preference
    localStorage.setItem('preferredLanguage', currentLanguage);
}

// Function to update all translations
function updateTranslations() {
    // Hero Section
    document.querySelector('.hero h1').textContent = t('heroTitle');
    document.querySelector('.hero-subtitle').textContent = t('heroSubtitle');
    document.querySelector('.hero-years').textContent = t('heroYears');

    // Navigation
    document.querySelector('.nav-container > div').textContent = t('navBrand');
    const navLinks = document.querySelectorAll('.nav-links a');
    navLinks[0].textContent = t('navOverview');
    navLinks[1].textContent = t('navTimeline');
    navLinks[2].textContent = t('navPopes');
    navLinks[3].textContent = t('navImpact');
    navLinks[4].textContent = t('navEvents');
    navLinks[5].textContent = t('navComparison');

    // Overview Section
    document.querySelector('#overview .section-header h2').textContent = t('overviewTitle');
    document.querySelector('#overview .section-header p').textContent = t('overviewDescription');

    const statCards = document.querySelectorAll('#overview .stat-card');
    statCards[0].querySelector('.stat-label').innerHTML = `${t('statYearsCovered')}<br>${t('statYearsRange')}`;
    statCards[1].querySelector('.stat-label').innerHTML = `${t('statPopes')}<br>${t('statPopesRange')}`;
    statCards[2].querySelector('.stat-label').innerHTML = `${t('statLongestPapacy')}<br>${t('statLongestName')}`;
    statCards[3].querySelector('.stat-label').innerHTML = `${t('statShortestPapacy')}<br>${t('statShortestName')}`;

    // Timeline Section
    document.querySelector('#timeline .section-header h2').textContent = t('timelineTitle');
    document.querySelector('#timeline .section-header p').textContent = t('timelineDescription');

    // Popes Section
    document.querySelector('#popes .section-header h2').textContent = t('popesTitle');
    document.querySelector('#popes .section-header p').textContent = t('popesDescription');

    // Impact Analysis Section
    document.querySelector('#impact .section-header h2').textContent = t('impactTitle');
    document.querySelector('#impact .section-header p').textContent = t('impactDescription');

    // Historical Events Section
    document.querySelector('#events .section-header h2').textContent = t('eventsTitle');
    document.querySelector('#events .section-header p').textContent = t('eventsDescription');

    // Comparison Table Section
    document.querySelector('#comparison .section-header h2').textContent = t('comparisonTitle');
    document.querySelector('#comparison .section-header p').textContent = t('comparisonDescription');

    // Comparison Table Headers
    const tableHeaders = document.querySelectorAll('.comparison-table th');
    tableHeaders[0].textContent = t('thPope');
    tableHeaders[1].textContent = t('thYearsServed');
    tableHeaders[2].textContent = t('thKeyAchievement');
    tableHeaders[3].textContent = t('thMajorChallenge');
    tableHeaders[4].textContent = t('thCulturalLegacy');

    // Footer
    const footerPs = document.querySelectorAll('.footer p');
    footerPs[0].innerHTML = `<strong>${t('footerEducational')}</strong> ${t('footerDescription')}`;
    footerPs[1].innerHTML = `${t('footerVisit')} <a href="https://www.copticchurch.net" target="_blank">${t('footerLink')}</a>`;
    footerPs[2].textContent = t('footerCopyright');

    // Re-render dynamic content with translations
    renderPopeCardsWithTranslations();
    renderImpactAnalysisWithTranslations();
}

// Function to render pope cards with translations
function renderPopeCardsWithTranslations() {
    const container = document.getElementById('popeCards');
    container.innerHTML = popesData.map((pope, index) => `
    <div class="pope-card" style="border-top: 4px solid ${pope.color}">
      <div class="pope-card-header" onclick="togglePopeCard(${index})">
        <img src="${pope.image}" alt="${pope.name}" class="pope-portrait" onerror="this.src='https://via.placeholder.com/150x200/${pope.color.replace('#', '')}/FFFFFF?text=${encodeURIComponent(pope.name)}'">
        <div class="pope-info">
          <div class="pope-number">${pope.number}${currentLanguage === 'ar' ? ' ' : 'th '}${t('popeOfAlexandria')}</div>
          <h3 class="pope-name">${pope.name}</h3>
          <div class="pope-coptic-name">${pope.coptic_name}</div>
          <div class="pope-birth-name">${t('birthName')}: ${pope.birth_name}</div>
          <div class="pope-years">${pope.papacy_start} - ${pope.papacy_end}</div>
          <div class="pope-era">${pope.era} â€¢ ${pope.years_served} ${pope.years_served !== 1 ? t('yearsServed') : t('yearServed')} ${t('served')}</div>
          <button class="expand-btn" id="expandBtn${index}">
            <span>${t('learnMore')}</span>
            <span class="expand-icon">â–¼</span>
          </button>
        </div>
      </div>
      <div class="pope-card-content" id="popeContent${index}">
        <div class="pope-tabs">
          <button class="tab-btn active" onclick="switchTab(${index}, 0)">${t('tabBiography')}</button>
          <button class="tab-btn" onclick="switchTab(${index}, 1)">${t('tabAchievements')}</button>
          <button class="tab-btn" onclick="switchTab(${index}, 2)">${t('tabChallenges')}</button>
          <button class="tab-btn" onclick="switchTab(${index}, 3)">${t('tabCulturalImpact')}</button>
          <button class="tab-btn" onclick="switchTab(${index}, 4)">${t('tabHistoricalContext')}</button>
        </div>
        <div class="tab-content active" id="tab${index}-0">
          <h4>${t('biographyHeader')}</h4>
          <p>${pope.biography}</p>
        </div>
        <div class="tab-content" id="tab${index}-1">
          <h4>${t('achievementsHeader')}</h4>
          <ul class="achievement-list">
            ${pope.achievements.map(a => `<li>${a}</li>`).join('')}
          </ul>
        </div>
        <div class="tab-content" id="tab${index}-2">
          <h4>${t('challengesHeader')}</h4>
          <ul class="challenge-list">
            ${pope.challenges.map(c => `<li>${c}</li>`).join('')}
          </ul>
        </div>
        <div class="tab-content" id="tab${index}-3">
          <h4>${t('culturalImpactHeader')}</h4>
          <p>${pope.cultural_impact}</p>
          <h4 style="margin-top: 1.5rem;">${t('legacyHeader')}</h4>
          <p>${pope.legacy}</p>
        </div>
        <div class="tab-content" id="tab${index}-4">
          <h4>${t('historicalContextHeader')}</h4>
          <p>${pope.context}</p>
          <p style="margin-top: 1rem;"><strong>${t('yearsLabel')}</strong> ${pope.birth_year}${pope.death_year ? ` - ${pope.death_year}` : ` - ${t('present')}`}</p>
          <p><strong>${t('birthPlaceLabel')}</strong> ${pope.birth_place}</p>
        </div>
      </div>
    </div>
  `).join('');
}

// Function to render impact analysis with translations
function renderImpactAnalysisWithTranslations() {
    const container = document.getElementById('impactGrid');
    const dimensionLabels = [
        t('impactInstitutional'),
        t('impactSpiritual'),
        t('impactGlobal'),
        t('impactChurchState'),
        t('impactInfrastructure')
    ];

    container.innerHTML = impactDimensions.map((dimension, index) => {
        const avgScore = dimension.scores.reduce((a, b) => a + b, 0) / dimension.scores.length;
        return `
      <div class="impact-item">
        <div class="impact-label">${dimensionLabels[index]}</div>
        <div class="impact-bar">
          <div class="impact-fill" style="width: ${avgScore * 10}%"></div>
        </div>
        <div style="font-size: 0.85rem; color: var(--color-text-secondary); margin-top: 0.5rem;">
          ${t('average')}: ${avgScore.toFixed(1)}/10
        </div>
      </div>
    `;
    }).join('');
}

// Initialize language from localStorage
function initLanguage() {
    const savedLanguage = localStorage.getItem('preferredLanguage');
    if (savedLanguage && savedLanguage !== 'en') {
        currentLanguage = savedLanguage;
        document.documentElement.lang = currentLanguage;
        document.documentElement.dir = currentLanguage === 'ar' ? 'rtl' : 'ltr';
    }
}
